# Chapter 17. 정규표현식

정규표현식은 정교한 문자열 매칭 기능을 제공한다.
정규 표현식에는 문자열 교체에 필요한 기능도 들어 있다.

정규표현식은 정규식이라고 부르기도 한다.

### 17.1 부분 문자열 검색과 대체

정규식으로 하는 일은 결국 문자열 속에서 부분 문자열을 찾는 일이며 찾은 부분을 교체할 때도 있다.

이들 메서드는 모두 대소문자를 구분한다.

String.prototype.toLowerCase는 원래 문자열은 그대로 두고 새 문자열을 반환한다.
자바스크립트의 문자열은 항상 불변이다.

부분 문자열을 찾아 교체하려면 String.prototype.replace를 사용한다.

### 17.2 정규식 만들기

자바스크립트의 정규식은 RegExp 클래스이다.
ReqExp 생성자로도 정규식을 만들 수 있지만 간편한 리터럴 문법도 없다.
정규식 리터럴은 슬래시로 감싼 형태이다.

### 17.3 정규식 검색

정규식이 만들어지면 다양한 옵션으로 문자열을 검색할 수 있다.

### 17.4 정규식을 사용한 문자열 교체

String.prototype.replace 메서드에도 정규식을 쓸 수 있다.

### 17.5 입력 소비

정규식은 입력 문자열을 소비하는 패턴이다.

정규식이 문자열을 '소비'할 때 사용하는 알고리즘

- 문자열 왼쪽에서 오른쪽으로 진행한다.
- 일단 소비한 글자에 다시 돌아오는 일은 없다.
- 한 번에 한 글자씩 움직이며 일치하는 것이 있는지 확인한다.
- 일치하는 것을 찾으면 해당하는 글자를 한꺼번에 소비한 후 다음 글자로 진행한다(정규식에 /g 플래그를 써서 전역으로 검색할 때에 해당한다).

### 17.6 대체

파이프(|)는 대체를 뜻하는 메타 문자이다.
정규식이 왼쪽에서 오른쪽으로 평가한다.

### 17.7 HTML 찾기

정규식으로는 HTML을 분석 할 수 없다.
무언가를 분석하려면 각 부분을 구성 요소로 완전히 ㅂ분해할 수 있어야 한다.
정규식은 아주 간단한 언어만 분석할 수 있다.

### 17.8 문자셋

문자셋은 글자 하나를 다른 것으로 대체하는 방법을 간단하게 줄인 것이다.

범위를 결합하는 것도 가능하다.

순서는 중요하지 않는다.
하이픈은 이스케이프해야 한다.
이스케이프하지 않으면 정규식은 하이픈을 범위를 표시하는 메타 문자라고 간주한다(닫는 대괄호 바로 앞에 쓰는 하이픈은 이스케이프하지 않아도 된다).

문자셋은 특정 문자, 또는 범위를 제외하고 찾을 수도 있다.
문자셋을 제외할 때는 캐럿(^)을 맨 앞에 쓰면 된다.

### 17.9 자주 쓰는 문자셋

매우 자주 쓰이는 일부 문자셋은 단축 표기가 따로 있다.
이들을 클래스라고 부르기도 한다.

\s 뒤에 있는 \*는 '숫자는 상관없으며 없어도 된다'는 의미이다.

이들 클래스를 사용하면 원치 않는 문자들을 빠르고 효율적으로 제거할 수 있다.

### 17.10 반복

반복 메타 문자는 얼마나 많이 일치해야 하는지 지정할 때 쓴다.

문자셋 다음의 +는 그 앞에 있는 요소가 하나 이상 있어야 한다는 뜻이다.

### 17.11 마침표와 이스케이프

정규식에서 마침표는 줄바꿈 문자를 제외한 모든 문자에 일치하는 특수 문자이다.
이 메타 문자는 입력이 어떤 문자이든 상관하지 않고 소비하려 할 때 주로 사용한다.

정규식 특수 문자를 이스케이프해서 일반 문자로 사용하려면 그 앞에 역슬래시를 붙이면 된다.

#### 17.11.1 진정한 와일드카드

[\s\S]는 공백인 모든 문자에 일치하는 동시에, 공백이 아닌 모든 문자에 일치한다.
간단히 말해 뭐든 일치하는 것이다.

### 17.12 그룹

그룹을 사용하면 하위 표현식을 만들고 단위 하나로 취급할 수 있다.

그룹을 사용하면 그 그룹에 일치하는 결과를 나중에 쓸 수 있도록 캡처할 수도 있다.
결과를 캡처하는 것이 기본값이지만, 캡처하지 않는 그룹도 만들 수 있다.

그룹은 괄호로 만든다.
캡처하지 않는 그룹은 (?:[subexpression]) 형태이고, 여기서 [subexpression]이 일치시키려 하는 패턴이다.

그룹에도 반복을 적용할 수 있다.
일반적으로 반복은 반복 메타 문자의 바로 왼쪽에 있는 문자 하나에 적용되지만, 그룹을 사용하면 그룹 전체에 반복을 적용한다.

### 17.13 소극적 일치, 적극적 일치

정규식은 기본적으로 적극적이다.
검색을 멈추기 전에 일치하는 것을 최대한 많이 찾으려고 한다는 뜻이다.

정규식은 일치할 가능성이 있는 동안은 문자를 소비하지 않고 계속 넘어간다.
그리고 그 과정을 적극적으로 진행한다.
정규식은 <i>를 만나면 </i>를 더는 찾을수 없을 때까지 소비하지 않고 진행한다.

### 17.14 역참조

그룹을 사용하면 역참조라는 테크닉도 쓸 수 있다.

서브그룹을 포함해, 정규식의 각 그룹은 숫자를 할당받는다.
숫자는 맨 왼쪽이 1번에서 시작해 오른쪽으로 갈 수록 1씩 늘어난다.
역슬래시 뒤에 숫자를 써서 이 그룹을 참조할 수 있다.
즉 \1은 맨 처음 일치한 그룹이다.

HTML에서는 태그의 속성값에 큰따옴표나 작은따옴표를 써야 한다.

### 17.15 그룹 교체

그룹을 사용하면 문자열 교체도 더 다양한 방법으로 할 수 있다.

### 17.16 함수를 이용한 교체

함수를 이용하면 아주 복잡한 정규식을 좀 더 단순한 정규식으로 분할할 수 있다.

String.prototype.replace에는 교체할 매개변수로 함수를 넘길 수 있다.

String.prototype.replace에 넘기는 함수는 다음 순서대로 매개변수를 받는다.

- 첫번째: 일치하는 문자열 전체(\$&와 같다.)
- 두번째: 일치하는 그룹(일치하는 것이 있다면). 일치하는 것이 여럿이라면 매개변수도 여러 개를 받는다.
- 세번째: 원래 문자열에서 일치하는 곳의 오프셋(숫자)
- 원래 문자열(거의 사용하지 않는다/)

String.prototype.replace는 함수가 반환하는 값을 써서 원래 문자열을 교체한다.
String.prototype.replace는 undefined를 문자열로 바꿔서 사용한다.

### 17.17 위치 지정

~~, \_\_을 정규식의 앵커라고 부른다.
앵커에는 두 가지 종류가 있다.
^는 문자열의 맨 처음을 나타내고, \$는 문자열의 마지막을 나타낸다.

앵커에는 특이한 기능이 있다.
문자열에 줄바꿈 문자가 들어있다면 각 줄의 처음과 끝을 찾을 수 잇다.
각 줄의 처음과 끝을 찾으면 m 플래그를 쓰면 된다.

### 17.18 단어 경계 일치

단어 경계 메타 문자인 \b와 \B는 앵커와 마찬가지로 입력을 소비하지 않는다.
입력을 소비하지 않는 것은 매우 유용한 특징이다.

단어 경계는 알파벳 또는 숫자(\w)로 시작하는 부분, 알파벳이나 숫자가 아닌 문자(\W)로 끝나는 부분, 또는 문자열의 시작이나 끝에 일치한다.

단어 경계는 특정 단어로 시작하거나, 특정 단어로 끝나거나, 특정 단어를 포함하는 텍스트를 찾을 때도 유용하다.

### 17.19 룩어헤드

룩어헤드는 앵커나 단어 경계와 마찬가지로 입력을 소비하지 않는다.
룩어헤드는 하위 표현식도 소비하지 않고 찾을 수 있으므로, 앵커와 단어 경계보다 범용적으로 쓸 수 있다.
룩어헤드는 문자열이 겹치는 상황에 필요하고, 룩어헤드를 써서 단순화시킬 수 있는 패턴이 많다.

룩어헤드는 입력을 소비하지 않는 독립적 정규식이다.
자바스크립트의 룩어헤드는(?=[subexpression]) 형태이다.
하위 표현식 뒤에 이어지지 않는 것만 찾는 부정형 룩어헤드(?![subexpression])도 있다.

### 17.20 동적으로 정규식 만들기

동적으로 정규식을 만들어야 할 때 RegExp 생성자가 필요하다.

역슬래시를 두 개 쓰지 않았다면 정규식 엔진은 \b를 리터럴 문자 b로 판단한다.
